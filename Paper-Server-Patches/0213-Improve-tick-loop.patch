From 735ed872a4c6bf76aee092b6aa008e3bc7f1e9c9 Mon Sep 17 00:00:00 2001
From: SotrForgotten <i@omc.hk>
Date: Mon, 1 Aug 2016 17:46:12 +0800
Subject: [PATCH] Improve tick loop

@@ -1018,7 +1026,7 @@ public abstract class MinecraftServer implements Runnable, ICommandListener, IAs
 		PlayerListTickTask(PlayerList playerlist) { this.playerlist = playerlist; }
         public void compute() { playerlist.tick(); }
     }
-
+	/*
 	class WorldTickThread extends Thread {
 		WorldServer worldserver;
 		WorldTickThread(WorldServer worldserver) {
@@ -1026,7 +1034,7 @@ public abstract class MinecraftServer implements Runnable, ICommandListener, IAs
 		}
         public void run() { worldserver.doTick(); }
     }
-	/*
+
 	class EntityTickThread extends Thread {
 		WorldServer worldserver;
 		EntityTickThread(WorldServer worldserver) {

diff --git a/src/main/java/net/minecraft/server/WorldServer.java b/src/main/java/net/minecraft/server/WorldServer.java
index 49812d9..e642de7 100644
--- a/src/main/java/net/minecraft/server/WorldServer.java
+++ b/src/main/java/net/minecraft/server/WorldServer.java
@@ -225,21 +225,21 @@ public class WorldServer extends World implements IAsyncTaskHandler {
 
     public void doTick() {
         super.doTick();
+		/*
         if (this.getWorldData().isHardcore() && this.getDifficulty() != EnumDifficulty.HARD) {
             this.getWorldData().setDifficulty(EnumDifficulty.HARD);
         }
-
+		*/
         this.worldProvider.k().b();
         if (this.everyoneDeeplySleeping()) {
             if (this.getGameRules().getBoolean("doDaylightCycle")) {
-                long i = this.worldData.getDayTime() + 24000L;
-
-                this.worldData.setDayTime(i - i % 24000L);
+                // long i = this.worldData.getDayTime() + 24000L;
+                // this.worldData.setDayTime(i - i % 24000L);
+				this.worldData.setDayTime(0L);
             }
 
             this.f();
         }
-
         // CraftBukkit start - Only call spawner if we have players online and the world allows for mobs or animals
         long time = this.worldData.getTime();
         if (this.getGameRules().getBoolean("doMobSpawning") && this.worldData.getType() != WorldType.DEBUG_ALL_BLOCK_STATES && (this.allowMonsters || this.allowAnimals) && (this instanceof WorldServer && this.players.size() > 0)) {
-- 
2.8.2.windows.1

